name: financial_analysis
description: >
  Extract structured financial insights strictly from provided documents.
  No predictions, no advice, and no interpretations beyond what the text explicitly supports.

cluster_schema:
  # ═══ DOMAIN-SPECIFIC FIELDS ═══
  financial_category: str         # classification of content (e.g., revenue, expenses, assets)
  financial_metrics: [str]        # specific metrics mentioned (e.g., revenue, OPEX, unit economics)
  key_figures: [str]              # numerical values explicitly stated in text
  trends_described: [str]         # trends only if explicitly stated in the source
  risks_or_constraints: [str]     # financial risks or limitations mentioned

  # ═══ SUMMARY FIELDS ═══
  topic: str                      # 1-sentence definition of what this financial cluster covers
  short: str                      # short summary (~1–2 sentences)
  long: str                       # longer, detailed summary (2–6 sentences)

  # ═══ EXTRACTION FIELDS ═══
  key_terms: [str]                # important grounded financial terms, extracted, not hallucinated
  notable_mentions: [str]         # companies, funds, instruments the model believes matter
  highlights: [str]               # the most significant financial findings in the cluster

  # ═══ UNCERTAINTY & MATCHING ═══
  ambiguities_or_red_flags: [str] # unclear figures, inconsistencies, or data gaps
  fuzzy_matches:
    "*": [str]                    # user-provided keywords → semantically related matches

  # ═══ TRACEABILITY ═══
  source_refs: [int]              # indices of chunks used; guarantees traceability
  raw_text_preview: str           # first ~200 chars of cluster text (verbatim)
  confidence_notes: str           # model's own uncertainty + reasoning on confidence

project_schema:
  # ═══ DOMAIN-SPECIFIC FIELDS (some optional - only fill if clearly present) ═══
  executive_summary: str          # high-level financial overview in 2–4 sentences
  major_financial_drivers?: [str] # key factors affecting financial performance
  constraints_or_risks?: [str]    # significant financial risks or limitations
  data_points?: [str]             # extracted numerical facts across all sources
  time_periods_covered?: [str]    # fiscal years, quarters, or date ranges in the data

  # ═══ OVERVIEW ═══
  title: str                      # concise project name derived from content
  overview: str                   # what this financial analysis covers in 2–4 sentences
  key_components: [str]           # major financial areas or segments analyzed

  # ═══ EXTRACTION ═══
  key_terms: [str]                # global glossary of important financial concepts
  notable_mentions: [str]         # prominent entities, instruments, or standards referenced
  major_highlights: [str]         # most consequential financial insights from entire docpack

  # ═══ UNCERTAINTY & MATCHING ═══
  ambiguities_or_red_flags: [str] # global data quality issues or inconsistencies
  fuzzy_matches:
    "*": [str]                    # user keywords → semantically related project-wide matches

  # ═══ METADATA ═══
  dataset_summary: str            # grounded numeric summary (files, figures extracted, periods)
  methodology_notes: str          # how this financial analysis was produced (pipeline steps, models)
  confidence_notes: str           # model-level uncertainty for global financial assessment
  metrics:
    file_count: int               # number of files ingested
    chunk_count: int              # number of final chunks
    cluster_count: int            # number of clusters chosen
    token_count: int              # total tokens across all chunks
    embedding_dim: int            # embedding vector dimensionality
